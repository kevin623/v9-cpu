###论文：Dune: Safe User-level Access to Privileged CPU Features
###摘要：
  通过访问特权硬件特性可以提高应用性能或者简化编程，但是对于特权特性不当使用会引发系统崩毁或者受损。本文提出了一种新方法Dune。Dune允许普通应用高效，安全的使用特权硬件特性，这些特性在传统上只能在内核态使用。它利用了现代cpu的虚拟化硬件，硬件虚拟化技术允许普通应用在非特权环境下直接访问特权性能。作者利用Intel VT-x虚拟架构，在linux下部署了dune，允许在用户级访问异常，虚拟内存和特权模式。作者从性能和安全两个方面对dune进行评估，实验证明这种方法很有效。
###论文要点：
1.Dune 架构
  Dune 用一个支持VT-x的模块对内核进行扩展，扩展内核位于VMX root mode。通过运行VMX non-root模式，用户进程可以直接并安全的访问特权硬件。Dune包括一个称为libDune的库在用户空间来帮助管理特权硬件特性。Dune模块需要VT-x支持，否则无法在虚拟机中使用。Dune 访问cpu特权特性不会影响系统现有的安全模式。内存管理是Dune最主要的职责之一。在普通虚拟化中，要把主机虚拟地址转化为主机物理地址，而在使用Dune的进程中，要将客户虚拟地址转化为客户物理地址，接着内核在负责把客户物理地址转化为主机物理地址。所有用户使用的内存参数都是被隔离的。Dune对系统调用进行保护。正常的系统调用指令在自身线程中执行。不会引发VM推出。相反，超级调用指令必须使用VMCAll进行系统调用。超级调用通过Dune模块使用内核的熊调用表，甚至某些情况它在调用系统调用前还要执行一些额外操作。
2.使用Dune的线程和普通线程有区别。普通线程工作在用户态，而使用dune的线程的代码工作在内核态。为了支持这种操作，作者提供了一种检查机制，一旦发现在ring0执行系统调用，自动的把它当做超级调用重定向到kernel执行。libDune就是专门为使用Dune的用户程序创建的一个库，用来简化操作。
3.Dune可以在很大范围应用。作者用它构建了两个与安全相关的应用，一个是沙盒一个是垃圾收集器。
 沙盒在用户态运行不可信的二进制代码，在内核态运行可信的sandbox runtime，这两种操作都位于一个地址空间里。一旦不可信的代码执行不安全的操作，libDune接收到一个异常，并且通过sandbox runtime执行一个操作。这样，sandbox runtime能过滤和限制不可信二进制代码的行为。垃圾回收器经常利用内存管理硬件加速收集。Dune提供了一个干净有效的方式直接访问相关硬件。通过修改Boehm GC可以利用Dune改善性能。
4.评估
  作者在一个四核的XeonE3-1230，16GB RAM，安装Debian LInux（Kernel 3.2）进行Dune性能测试。我们对getpid，page fault,page walk的操作时间进行了测试，发现采用dune 后时间变长了。原因是：VT-增加了进入和退出内核的开销：使用EPT要页表切换。作者这里是想说明，采用Dune必要开销不可缺少；此外，这些测试平台并不能代表真正的应用。访问特权硬件特性可以进行很多优化处理。在Table3中对ptrace，trap，appel1，appel2进行测试，采用Dune后时间大幅变短。说明优化效果很明显。在Figure3 中，利用SPEC2000进行测试。结果显示，采用Dune后，cpu测试性能变好了（与未采用dune作比较）。Table4：表明用Lighttpd测试IO，采用Dune性能和linux相当。Table5表明，Wedge测试，采用Dune创建，切换线程和http服务都有明显改进。因为复用要比创建新的进程开销要小得多；利用带标签的的TLB，可以避免内核调用。
 结论：采用Dune对于性能和安全性都是有改进的。




